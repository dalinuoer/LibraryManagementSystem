### 一.Book.h（书本类）

#### 私有成员：

|     属性     |  长度/类型   |               备注                |
| :----------: | :----------: | :-------------------------------: |
|      id      |     int      |          主键，唯一标识           |
|     ISBN     | 35/char数组  |           书本唯一标识            |
|    image     | 200/char数组 |             图片路径              |
|   BookName   | 50/char数组  |               书名                |
|    author    | 50/char数组  |               作者                |
|    press     | 50/char数组  |              出版社               |
| introduction | 500/char数组 |             书本简介              |
|   category   |    int    | 书本分类-外键-连接bookCategory-id |
|    amount    |    int    |             书本总数              |
|     left     |    int    |            书本剩余数             |

#### 成员函数：

|                             接口                             |                   参数说明                    |                        实现功能及说明                        |
| :----------------------------------------------------------: | :-------------------------------------------: | :----------------------------------------------------------: |
| Book(int ID=-1,string ISBN="", string image="",string bookName="",string author="",string press="",string introduction="",int category=-1,int amount=-1,int left=-1); |            与类的私有成员保持一致             | **功能**：Book类的构造函数。用来实例化书本对象，ID、category、amount、left默认为-1.其余string类型的默认为"" |
|                      string getISBN();                       |                      无                       |                **功能**：获取该本书对象的ISBN                |
|                    string getBookName();                     |                      无                       |                **功能**：获取该本书对象的书名                |
|                     string getAuthor();                      |                      无                       |                **功能**：获取该本书对象的作者                |
|                      string getPress();                      |                      无                       |               **功能**：获取该本书对象的出版社               |
|                  string getIntroduction();                   |                      无                       |                **功能**：获取该本书对象的简介                |
|                      int getCategory();                      |                      无                       | **功能**：获取该本书对象的分类ID（获取分类ID后，可调用Category类的接口获取分类名字） |
|                       int getAmount();                       |                      无                       |                 **功能**：获取该对象的总数量                 |
|                        int getLeft();                        |                      无                       |              **功能**：获取该本书对象的可借数量              |
|                     void setID(int ID);                      |             **ID**为这本书的新ID              | 设置当前对象的新ID(ID为-1时，调用save函数表明增加一本书，否则则是更新这本书的信息) |
|                  void setISBN(string ISBN）                  |           **ISBN**为这本书的新书号            |                **功能**：设置当前对象的新书号                |
|                 void setImage(string image)                  |        **image**为这本书的新封面的路径        |                **功能**：设置当前对象的新封面                |
|              void setBookName(string bookName)               |         **bookName**为这本书的新书名          |                **功能**：设置当前对象的新书名                |
|                void setAuthor(string author)                 |          **Author**为这本书的新书号           |                 **功能**：设置这本书的新书号                 |
|                 void setPress(string press)                  | **name**为学生姓名，**major**为学生专业的序号 | 通过学生的姓名和专业查询同时符合两个条件的学生信息，返回一个存储Student对象的vector向量 |
|          void setIntroduction(string introduction)           |       **introduction**为这本书的新简介        |                **功能**：设置当前对象的新简介                |
|                void setCategory(int category)                |     **category**是这本书的新分类的分类ID      |              **功能**：设置当前对象的新分类的ID              |
|                  void setAmount(int amount)                  |         **amount**为这本书的新总数量          |               **功能**：设置当前对象的新总数量               |
|                    void setLeft(int left)                    |        **left**为这本书的新的可借数量         |             **功能**：设置当前对象的新的可接数量             |
|                         bool save()                          |                      无                       | **功能**：把这本书对象存到数据库里（新增或者更新书的信息）。**操作**：当ID为-1时代表新增一本书，利用时间哈希出一个不会重复的ISBN，设为该本书的ISBN，再把这本书存到数据库。当ID不为-1时，利用这本书的唯一标识ID，更新这本书的信息 |
|                        bool destory()                        |                      无                       | **功能**：把这本书对象从数据库里删除。**删除条件**：当这本书没有被人借走/被人预约，才能删除这本书。**删除操作**：删除这本书时，会把这本书的收藏记录、预约记录、借阅历史同时删除。 |
#### 外部接口：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|static Book getBookByISBN(string ISBN)| **ISBN**书本的书号 | **功能**：获取这个书号的书的信息。**操作**：调用Dao类的select接口，条件查询数据，并把数据转换成Book对象返回       |
| static vector<Book> getBook(string bookName, string author, int category); | **bookName**：书名 **author**：作者 **Category**：分类ID|        **功能**：查询同时满足书名，作者，分类的书本对象。**操作**：调用Dao类的select多重分页查询同时满足书名，作者，分类的信息，若无需查询某个参数，只需将string类型用""作为参数，int类型用-1作为参数，输入页面大小，页数和获取总数的指针，来获取对应页数的信息，从而避免了一次性检索所有数据|

### 二.BookCategory.h（书分类 类）
#### 私有成员：
|    属性    |   长度/类型   |   备注    |
| :------: | :-------: | :-----: |
|    id    |  int   | 主键，唯一标识 |
| category | 40/char数组 |  分类名称   |

#### 成员函数：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|BookCategory(int ID=-1, string category="") | 与类的私有成员保持一致 |**功能**：BookCategory类的构造函数。用来实例化书分类对象，ID默认为-1.分类名字的默认为""|
|int getID() |无 |**功能**：返回该分类对象的ID，唯一标识|
|string getCategory() |无 |**功能**：返回该分类对象的分类名|
|void setCategory(string category) |**category**为这个分类对象的新分类名 |**功能**：用来设置分类对象的分类名|
|void setID(int ID) |**ID**为这个分类对象的ID |**功能**：设置分类对象的新ID|
|bool save() |无 |**功能**：把这个分类对象存到数据库里（新增或者更新分类）。**操作**：当ID为-1时代表新增一个分类，先判断该分类名与数据库中的分类，是否重名，若不重名才可添加。当ID不为-1时，利用这个分类的唯一标识ID，更新这个分类的分类名（也需判断修改后的分类名是否与其他分类重名）|
|bool destroy() |无 |**功能**：把这个分类对象从数据库里删除。**删除条件**：当这个分类下面没有书籍时，才能删除这个分类。**删除操作**：删除这个分类。|
#### 外部接口：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|static map<int, string> getAllCategory() |无 |**功能**：返回所有的分类对象|
|static int getCategoryIdByName(string categoryName) |**categoryName**：要查找的分类名字|**功能**：通过传入的分类名字找到该分类对象的ID|
|static string getCategoryNameByID(int ID)|**ID**：要查找的分类ID|**功能**：通过传入的分类ID来找到该分类对象的分类名|

###三、BorrowInfo.h（借阅记录类）
####私有成员
|    属性    |   长度/类型   |           备注           |
| :------: | :-------: | :--------------------: |
|    id    |  int   |        主键，唯一标识         |
| numberID | 13/char数组 |           学号（借书者）  |
| ISBN-xxx | 35/char数组 |借阅ID（“借阅书籍ISBN-某个由借阅时间哈希出的不重复的值”）|
|  b_date  | 20/char数组 |          借书时间          |
|  r_date  | 20/char数组 |          还书时间          |
|  Book_status  |  enum   | 状态：正常-Book_NORMAL 续借-Book_DELAY 已还-Book_DONE 逾期-Book_EXCEED |

#### 成员函数：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|BorrowInfo(int ID = -1, string numberID = "", string ISBN_ID = "", string b_date = "", string r_date = "", Book_status status = (Book_status)0) | 与类的私有成员保持一致 |**功能**：BorrowInfo类的构造函数。用来实例化借阅记录类对象，ID默认为-1.学号、ISBN-ID、借阅时间、归还时间默认为""，借书状态默认为正常|
|int getID() |无|**功能**：返回该借阅信息对象的ID|
|string getNumberID() |无|**功能**：返回该借阅记录对象的学号（借书者）|
|string getISBN_ID() |无|**功能**：返回该借阅记录对象的借阅ID|
|string getB_date() |无 |**功能**：返回该借阅记录对象的借书时间|
|string getR_date() |无|**功能**：返回该借阅记录对象的归还时间（用户的归还时间）|
|Book_status getStatus() |无|**功能**：返回该借阅记录对象的借书状态|
|void setID(int ID)|**ID**：该对象的新ID|**功能**：设置该对象的新ID|
|void setNumberID(string numberID)|**numberID**：该对象的新用户学号|**功能**：设置该对象的numberID|
|void setISBN_ID(string ISBN_ID)|**ISBN_ID**:该对象的新的借阅ID|**功能**：设置该对象的借阅ID|
|void setB_date(string b_date)|**b_date**:该对象的新的借阅时间|**功能**：设置该对象的借阅时间|
|void setR_date(string r_date)|**r_date**:该对象的新的还书时间|**功能**：设置该对象的还书时间属性|
|void setStatus(Book_status status)|**status**：该对象的新的借书状态|**功能**：设置该对象的借阅状态属性|
|bool save()|无 |**功能**：把这个借阅记录对象存到数据库里（新增或者更新借阅记录）。**操作**：当ID为-1时代表新增一个借阅记录，这本书不存在或如果该本书的剩余数量<=0或如果这本书的预约数大于等于剩余数时，说明不能再借了。能借的时候，先通过时间哈希出一个不重复的值，与传进来的书的ISBN进行拼接，即“借阅书籍ISBN-某个由借阅时间哈希出的不重复的值”。然后在获取当前时间，设置用户的借阅时间，以及应还时间（借阅时间+30），并把借阅状态置正常。最后把这个借阅记录对象存入数据库。当ID不为-1时，利用这个借阅记录的唯一标识ID，更新这个借阅记录|
|bool destroy()|无 |**功能**：把这个借阅记录对象从数据库里删除。**删除条件**：无。**删除操作**：删除这条借阅记录。|

#### 外部接口：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|static bool returnBook(BorrowInfo b) |**b**:要归还的书的借阅记录 |**功能**：还书。**操作**：先通过ISBN_ID找出借阅书籍对象，把借阅书籍可借数量+1。再获取系统当前时间，设置该条借阅记录的归还时间，并把该条借阅记录的借阅状态置为“已归还”。|
|static bool renewBook(BorrowInfo b) |**b**:要续借的书的借阅记录|**功能**：续借。**操作**：先判断这本书是否已经逾期，以及是否续借过。若逾期/续借过，那么将不能再续借。若借书状态为正常，则把用户应还时间+7，并把借书状态置为“续借”。|
|static vector<Student> getStudentInfoByISBN(string ISBN) |**ISBN**：书的唯一标识ISBN|**功能**：通过ISBN查找该本书的当前借阅用户信息。**操作**：首先更新借阅记录表中的借阅状态（若系统当前时间大于应还时间，把借书状态改为“逾期”）。先查找这本书的所有当前借阅记录信息，再通过借阅信息中的用户学号查找该用户的所有个人信息。|
|static vector<BorrowInfo> getInfoByISBN(string ISBN)|**ISBN**：书的唯一标识ISBN|**功能**：通过ISBN查找该本书的所有历史借阅记录。**操作**：先更新借阅记录表中的借阅状态（若系统当前时间大于应还时间，把借书状态改为“逾期”），查找借阅记录中ISBN_ID中的ISBN为传入的ISBN值的所有借阅记录|
|static vector<BorrowInfo> getInfoByNumberID(string numberID, Book_status status)|**numberID**:用户学号 **status**:借书状态|**功能**：查找该用户的某个借书状态（正常/续借/逾期/已还）的借阅记录。**操作**：先更新借阅记录表中的借阅状态（若系统当前时间大于应还时间，把借书状态改为“逾期”），再查找该用户的某个借书状态（正常/续借/逾期/已还）的借阅记录。|
|static vector<BorrowInfo> getNowInfoByNumberID(string numberID)|**numberID**:用户学号|**功能**：查找该用户的当前借阅记录（正常，续借，逾期）。**操作**：先更新借阅记录表中的借阅状态（若系统当前时间大于应还时间，把借书状态改为“逾期”），再查找该用户的当前借阅记录（正常，续借，逾期）。|
|static vector<BorrowInfo> getHistoryInfoByNumberID(string numberID)|**numberID**:用户学号|**功能**：查找该用户的所有历史借阅记录（正常，续借，逾期，已还）。**操作**：先更新借阅记录表中的借阅状态（若系统当前时间大于应还时间，把借书状态改为“逾期”），再查找该用户的所有历史借阅记录（正常，续借，逾期，已还）。|
|static vector<BorrowInfo> getHistoryInfoByNumberID(string numberID,int pagesize,int page,int* total)|**numberID**:用户学号 **pagesize**:每页数据条数 **page**：返回第几页的数据 **total**:数据总共有多少条|**功能**：按照页数返回该用户的所有历史借阅记录（正常，续借，逾期，已还）。**操作**：先更新借阅记录表中的借阅状态（若系统当前时间大于应还时间，把借书状态改为“逾期”），再查找该用户的所有历史借阅记录（正常，续借，逾期，已还），按页数返回（防止数据量过大爆了容器）。|

###四、CollectBook.h（收藏记录类）
####私有成员
|    属性    |   长度/类型   |   备注    |
| :------: | :-------: | :-----: |
|    id    |  int   | 主键，唯一标识 |
| numberID | 13/char数组 |   学号    |
|   ISBN   | 35/char数组 |   书号    |
#### 成员函数：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|CollectBook(int ID=-1, string numberID="", string ISBN="")|与类的私有成员保持一致|**功能**：CollectBook类的构造函数。用来实例化收藏信息类对象，ID默认为-1.学号、ISBN默认为""|
|int getID()|无|**功能**：返回该对象的ID|
|string getNumberID()|无|**功能**：返回该对象的学号|
|string getISBN()|无|**功能**：返回该对象的ISBN|
|void setID(int ID)|**ID**：该对象的新ID|**功能**：设置该对象的ID|
|void setNumberID(string numberID)|**numberID**：该对象的新学号|**功能**：设置该对象的学号|
|void setISBN(string ISBN)|**ISBN**：该对象的新ISBN|**功能**：设置该对象的ISBN|
|bool save()|无 |**功能**：把这个收藏记录对象存到数据库里（新增或者更新收藏记录）。**操作**：当ID为-1时代表新增一个收藏记录，这本书不存在或者该用户已经收藏了这本书的时候，说明不能进行收藏。能收藏的时候，把这个收藏记录对象存入数据库。当ID不为-1时，利用这个收藏记录的唯一标识ID，更新这个收藏记录|
|bool destory()|无 |**功能**：把这个收藏记录对象从数据库里删除。**删除条件**：无。**删除操作**：删除这条收藏记录。|

#### 外部接口：
|    接口     |  参数说明 |  实现功能及说明  |
| :--------: | :------: | :------------: |
|static vector<CollectBook> getCollectionByNumberID(string numberID)|**numberID**：用户学号|**功能**：查找出传入用户的全部收藏记录信息|
|static vector<CollectBook> getCollectionByISBN(string ISBN)|**ISBN**：书号|**功能**：根据ISBN查找出这本书被收藏的所有收藏记录信息|
|static vector<CollectBook> getCollectionByNumberID(string numberID, int pagesize, int page, int* total)|**numberID**：用户学号 **pagesize**:每页数据条数 **page**：返回第几页的数据 **total**:数据总共有多少条|**功能**：按页数返回传入用户的收藏记录信息|